收到，我将进一步细化设计，特别是针对您关心的 **右键菜单 (Context Menu)** 部分，我们将打造一个**上下文感知 (Context-Aware)** 的智能菜单系统。

### 核心组件设计：`TableSmartToolbar` & `SmartContextMenu`

#### 1. 智能右键菜单设计 (SmartContextMenu)

我们将废弃原有的简易菜单，开发一个支持**二级导航、图标指示、状态禁用**的专业级菜单组件。根据用户点击的位置不同，智能展示不同的功能项：

**A. 行控制菜单 (点击左侧行头触发)**

* 🎯 **选中状态**：自动选中当前行（或多行）。

* 📋 **菜单项**：

  1. **剪切/复制/粘贴** (Cut/Copy/Paste)
  2. <br />

     ***
  3. **上方插入行** (Insert Row Above) `[图标]`
  4. **下方插入行** (Insert Row Below) `[图标]`
  5. <br />

     ***
  6. **删除行** (Delete Row) `[红色警示]`
  7. **清空内容** (Clear Contents)

**B. 列控制菜单 (点击上方列头触发)**

* 🎯 **选中状态**：自动选中当前列（或多列）。

* 📋 **菜单项**：

  1. **剪切/复制/粘贴**
  2. <br />

     ***
  3. **左侧插入列** (Insert Column Left) `[图标]`
  4. **右侧插入列** (Insert Column Right) `[图标]`
  5. <br />

     ***
  6. **删除列** (Delete Column) `[红色警示]`

**C. 单元格通用菜单 (点击表格内部触发)**
这是功能最丰富的部分，支持多级操作：

* 📋 **一级菜单**：

  1. **合并/拆分** (Merge/Split) `[智能显隐]`

     * *仅当选中多格时显示 "合并单元格"*

     * *仅当选中合并格时显示 "取消合并"*
  2. **对齐方式** (Alignment) `[二级菜单 >]`

     * 左对齐 / 居中 / 右对齐

     * 顶端对齐 / 垂直居中 / 底端对齐
  3. **插入...** (Insert) `[二级菜单 >]`

     * 行 (上/下)

     * 列 (左/右)
  4. **删除...** (Delete) `[二级菜单 >]`

     * 删除所在行

     * 删除所在列

     * **删除整个表格**
  5. **表格属性** (Properties)

     * 边框样式、背景颜色设置

     * <br />

#### 2. 工具栏交互细节 (Toolbar Interaction)

* **悬浮反馈**：鼠标滑过行/列头时，显示深色背景并高亮对应的表格区域，让用户明确知道操作范围。

* **快捷插入**：

  * 在列头/行头的**缝隙处**，设计隐形的“热区”。

  * 当鼠标靠近缝隙时，显示一个蓝色的 **(+)** 圆形按钮。

  * 点击 **(+)** 直接插入行/列，无需通过右键菜单。

#### 3. 执行路线图

1. **底层能力扩充**：(隐式任务) 为了支持菜单中的 "合并/拆分" 按钮，我必须先在 `TableHandler` 中补齐 `mergeCells` 和 `splitCell` 算法。
2. **UI 组件开发**：开发 `TableSmartToolbar` 及其子组件 `RowIndicator`, `ColIndicator`。
3. **菜单逻辑实现**：开发 `SmartContextMenu`，实现根据点击目标（Target）动态过滤菜单项的逻辑。

这个方案确保了右键菜单不仅功能全面，而且操作逻辑符合直觉（在哪里点，就出什么菜单）。请确认是否开始构建？
