# useEditorCommands Hook æµ‹è¯•å®ŒæˆæŠ¥å‘Š

## æµ‹è¯•æ–‡ä»¶ä¿¡æ¯

- **æµ‹è¯•æ–‡ä»¶**: `test/editor/useEditorCommands.test.ts`
- **æºæ–‡ä»¶**: `components/editor/toolbar/hooks/useEditorCommands.ts`
- **æµ‹è¯•ç”¨ä¾‹æ€»æ•°**: 44ä¸ª
- **æµ‹è¯•é€šè¿‡ç‡**: 100% (44/44)
- **æµ‹è¯•æ‰§è¡Œæ—¶é—´**: ~1.2ç§’

---

## æµ‹è¯•è¦†ç›–èŒƒå›´

### åœºæ™¯ 1: åŸºç¡€Hookæ¸²æŸ“ (3ä¸ªæµ‹è¯•)
- TC-EC-001: åˆå§‹åŒ–é»˜è®¤çŠ¶æ€
- TC-EC-002: æ­£ç¡®è·å–iframeæ–‡æ¡£
- TC-EC-003: iframeRefä¸ºnullæ—¶è¿”å›null

### åœºæ™¯ 2: åŸºç¡€æ–‡æœ¬æ ¼å¼åŒ–å‘½ä»¤ (3ä¸ªæµ‹è¯•)
- TC-EC-004: æ‰§è¡Œboldå‘½ä»¤
- TC-EC-005: æ‰§è¡Œitalicå‘½ä»¤
- TC-EC-006: æ‰§è¡Œunderlineå‘½ä»¤

### åœºæ™¯ 3: å¯¹é½å‘½ä»¤ (2ä¸ªæµ‹è¯•)
- TC-EC-007: æ‰§è¡ŒjustifyLeftå‘½ä»¤
- TC-EC-008: æ‰§è¡ŒjustifyCenterå‘½ä»¤

### åœºæ™¯ 4: åˆ—è¡¨å‘½ä»¤ (2ä¸ªæµ‹è¯•)
- TC-EC-009: æ‰§è¡ŒinsertUnorderedListå‘½ä»¤
- TC-EC-010: æ‰§è¡ŒinsertOrderedListå‘½ä»¤

### åœºæ™¯ 5: é¢œè‰²å‘½ä»¤ (2ä¸ªæµ‹è¯•)
- TC-EC-011: æ‰§è¡ŒforeColorå‘½ä»¤
- TC-EC-012: æ‰§è¡ŒhiliteColorå‘½ä»¤

### åœºæ™¯ 6: æ ¼å¼åˆ·åŠŸèƒ½ (5ä¸ªæµ‹è¯•) ğŸ”´é«˜é£é™©
- TC-EC-013: é¦–æ¬¡è°ƒç”¨æ¿€æ´»æ ¼å¼åˆ·
- TC-EC-014: ç¬¬äºŒæ¬¡è°ƒç”¨åœç”¨æ ¼å¼åˆ·
- TC-EC-015: æ¿€æ´»æ—¶æ•è·å½“å‰æ ·å¼
- TC-EC-016: åœç”¨æ—¶ä¸æ•è·æ ·å¼
- **TC-EC-032: æ ¼å¼åˆ·æ¿€æ´»åé€‰æ‹©æ–‡æœ¬è‡ªåŠ¨åº”ç”¨ (é«˜é£é™©)**

### åœºæ™¯ 7: æ ·å¼åº”ç”¨ (2ä¸ªæµ‹è¯•)
- TC-EC-017: ä½¿ç”¨fontSizeè‡ªå®šä¹‰æ ·å¼
- TC-EC-018: ä½¿ç”¨fontFamilyè‡ªå®šä¹‰æ ·å¼

### åœºæ™¯ 8: æ’å…¥å‘½ä»¤ (3ä¸ªæµ‹è¯•)
- TC-EC-019: æ’å…¥å›¾ç‰‡
- TC-EC-020: æ’å…¥æ°´å¹³çº¿
- TC-EC-021: åˆ›å»ºé“¾æ¥

### åœºæ™¯ 9: å†å²å‘½ä»¤ (2ä¸ªæµ‹è¯•)
- TC-EC-022: æ‰§è¡Œundoå‘½ä»¤
- TC-EC-023: æ‰§è¡Œredoå‘½ä»¤

### åœºæ™¯ 10: è¾¹ç•Œæƒ…å†µ (7ä¸ªæµ‹è¯•)
- TC-EC-024: éç¼–è¾‘æ¨¡å¼ä¸æ‰§è¡Œå‘½ä»¤
- TC-EC-025: iframeRefä¸ºnullä¸æ‰§è¡Œå‘½ä»¤
- TC-EC-026: å¤„ç†removeFormatå‘½ä»¤
- TC-EC-027: æ’å…¥è¡¨æ ¼
- TC-EC-028: è°ƒç”¨lineHeightå‘½ä»¤
- TC-EC-029: å¤„ç†formatBlockå‘½ä»¤
- TC-EC-030: å¤„ç†unlinkå‘½ä»¤

### åœºæ™¯ 11: å†…å®¹å˜æ›´å›è°ƒ (1ä¸ªæµ‹è¯•)
- TC-EC-031: è°ƒç”¨onContentChangeä¼ é€’æ–°HTML

### åœºæ™¯ 12: æ ¼å¼åˆ·è¾¹ç•Œæƒ…å†µ (2ä¸ªæµ‹è¯•)
- TC-EC-033: å–æ¶ˆæ ¼å¼åˆ·æ—¶æ¸…ç©ºä¿å­˜çš„æ ·å¼
- TC-EC-037: é€‰æ‹©æŠ˜å æ—¶ä¸è‡ªåŠ¨åº”ç”¨

### åœºæ™¯ 13: è‡ªå®šä¹‰æ ·å¼åº”ç”¨ (2ä¸ªæµ‹è¯•)
- TC-EC-034: applyCustomStyleè°ƒç”¨applyStyleå¹¶è§¦å‘onContentChange
- TC-EC-035: applyLineHeightè®¾ç½®å—å…ƒç´ çš„lineHeight

### åœºæ™¯ 14: é€‰æ‹©æ¢å¤å¤±è´¥å¤„ç† (1ä¸ªæµ‹è¯•)
- TC-EC-036: é€‰æ‹©æ¢å¤å¤±è´¥æ—¶çš„é”™è¯¯å¤„ç†

### åœºæ™¯ 15: é¢å¤–å‘½ä»¤æµ‹è¯• (7ä¸ªæµ‹è¯•)
- TC-EC-EXT-001: æ‰§è¡ŒstrikeThroughå‘½ä»¤
- TC-EC-EXT-002: æ‰§è¡Œsubscriptå‘½ä»¤
- TC-EC-EXT-003: æ‰§è¡Œsuperscriptå‘½ä»¤
- TC-EC-EXT-004: æ‰§è¡ŒjustifyRightå‘½ä»¤
- TC-EC-EXT-005: æ‰§è¡ŒjustifyFullå‘½ä»¤
- TC-EC-EXT-006: æ‰§è¡Œindentå‘½ä»¤
- TC-EC-EXT-007: æ‰§è¡Œoutdentå‘½ä»¤

---

## å…³é”®åŠŸèƒ½è¦†ç›–

### Hookè¿”å›å€¼
- âœ… commandså¯¹è±¡
- âœ… isFormatPainterActiveçŠ¶æ€
- âœ… isUpdatingçŠ¶æ€
- âœ… getIframeDocæ–¹æ³•

### æ–‡æœ¬æ ¼å¼åŒ–å‘½ä»¤
- âœ… bold, italic, underline
- âœ… strikeThrough, subscript, superscript

### å¯¹é½å‘½ä»¤
- âœ… justifyLeft, justifyCenter
- âœ… justifyRight, justifyFull

### åˆ—è¡¨å‘½ä»¤
- âœ… insertUnorderedList, insertOrderedList

### ç¼©è¿›å‘½ä»¤
- âœ… indent, outdent

### æ’å…¥æ“ä½œ
- âœ… createLink (å¸¦prompt)
- âœ… insertImage
- âœ… insertHorizontalRule
- âœ… insertTable

### æ ·å¼åº”ç”¨
- âœ… fontSize, fontFamily
- âœ… foreColor, hiliteColor
- âœ… lineHeight
- âœ… formatBlock

### å†å²æ“ä½œ
- âœ… undo, redo

### å…¶ä»–å‘½ä»¤
- âœ… unlink, removeFormat

### æ ¼å¼åˆ· (é«˜é£é™©)
- âœ… æ¿€æ´»/åœç”¨
- âœ… æ ·å¼æ•è·
- âœ… è‡ªåŠ¨åº”ç”¨
- âœ… é€‰æ‹©æŠ˜å å¤„ç†

---

## æµ‹è¯•ç­–ç•¥

### Mockå¯¹è±¡
- HTMLIFrameElement with contentDocument
- Document with execCommand, queryCommandState, queryCommandValue
- Selectionå¯¹è±¡with rangeCount, anchorNode, isCollapsedç­‰å±æ€§
- window.prompt (ç”¨äºcreateLinkæµ‹è¯•)

### æµ‹è¯•å·¥å…·
- `@testing-library/react` çš„ renderHook
- act() åŒ…è£…çŠ¶æ€æ›´æ–°
- jest.fn() åˆ›å»ºmockå‡½æ•°
- createMockIframe() åˆ›å»ºæ¨¡æ‹Ÿiframe

### è¾¹ç•Œæƒ…å†µå¤„ç†
- iframeRefä¸ºnull
- éç¼–è¾‘æ¨¡å¼
- é€‰æ‹©ä¸ºæŠ˜å çŠ¶æ€
- DOMæ“ä½œå¼‚å¸¸

---

## ä»£ç è¦†ç›–ä¼°è®¡

åŸºäº44ä¸ªæµ‹è¯•ç”¨ä¾‹çš„è¦†ç›–æƒ…å†µï¼š

- **è¯­å¥è¦†ç›–**: ~90%+
- **åˆ†æ”¯è¦†ç›–**: ~85%+
- **å‡½æ•°è¦†ç›–**: ~95%+
- **è¡Œè¦†ç›–**: ~90%+

æ‰€æœ‰ä¸»è¦åŠŸèƒ½è·¯å¾„éƒ½å·²æµ‹è¯•ï¼ŒåŒ…æ‹¬ï¼š
- æ‰€æœ‰å‘½ä»¤æ‰§è¡Œå‡½æ•°
- æ ¼å¼åˆ·çš„å®Œæ•´æµç¨‹ï¼ˆæ¿€æ´»â†’æ•è·â†’åº”ç”¨â†’åœç”¨ï¼‰
- é€‰æ‹©ä¿å­˜å’Œæ¢å¤
- é”™è¯¯å¤„ç†è·¯å¾„

---

## è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰useEditorCommandsæµ‹è¯•
npm test -- --testPathPatterns=useEditorCommands

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm test -- --testPathPatterns=useEditorCommands --coverage

# åªè¿è¡Œå¤±è´¥çš„æµ‹è¯•
npm test -- --testPathPatterns=useEditorCommands --onlyFailures

# ç›‘è§†æ¨¡å¼ï¼ˆå¼€å‘æ—¶ä½¿ç”¨ï¼‰
npm test -- --testPathPatterns=useEditorCommands --watch
```

---

## æµ‹è¯•å®Œæˆæ£€æŸ¥æ¸…å•

- âœ… æ‰€æœ‰44ä¸ªæµ‹è¯•ç”¨ä¾‹é€šè¿‡
- âœ… è¦†ç›–æ‰€æœ‰å‘½ä»¤æ‰§è¡Œæ–¹æ³•
- âœ… è¦†ç›–æ ¼å¼åˆ·çš„å®Œæ•´æµç¨‹
- âœ… è¦†ç›–æ‰€æœ‰è¾¹ç•Œæƒ…å†µ
- âœ… è¦†ç›–é«˜é£é™©ç”¨ä¾‹ (TC-EC-032)
- âœ… Mockç­–ç•¥æ­£ç¡®å®æ–½
- âœ… æµ‹è¯•æ‰§è¡Œæ—¶é—´ <2ç§’
- âœ… æ— æµ‹è¯•æ³„æ¼æˆ–å‰¯ä½œç”¨

---

## é«˜é£é™©æµ‹è¯•ç”¨ä¾‹è¯¦æƒ…

### TC-EC-032: æ ¼å¼åˆ·æ¿€æ´»åé€‰æ‹©æ–‡æœ¬è‡ªåŠ¨åº”ç”¨

è¿™æ˜¯è¢«æ ‡è®°ä¸ºğŸ”´é«˜é£é™©çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå› ä¸ºï¼š
1. æ¶‰åŠå¤æ‚çš„å¼‚æ­¥äº‹ä»¶å¤„ç†
2. éœ€è¦æ­£ç¡®æ¨¡æ‹Ÿmouseupäº‹ä»¶
3. éœ€è¦æ¨¡æ‹Ÿé€‰æ‹©çŠ¶æ€å˜åŒ–
4. æ ¼å¼åˆ·çš„è‡ªåŠ¨åœç”¨é€»è¾‘

**æµ‹è¯•æ­¥éª¤**:
1. åˆ›å»ºå¸¦æ ·å¼çš„æ–‡æœ¬å…ƒç´ 
2. æ¿€æ´»æ ¼å¼åˆ·ï¼ˆæ•è·æ ·å¼ï¼‰
3. åˆ›å»ºæ–°çš„çº¯æ–‡æœ¬å…ƒç´ 
4. æ¨¡æ‹Ÿmouseupäº‹ä»¶è§¦å‘è‡ªåŠ¨åº”ç”¨
5. éªŒè¯æ ¼å¼åˆ·å·²è‡ªåŠ¨å…³é—­

---

## æµ‹è¯•è´¨é‡è¯„ä¼°

### ä¼˜ç‚¹
1. æµ‹è¯•è¦†ç›–å…¨é¢ï¼ŒåŒ…æ‹¬æ‰€æœ‰ä¸»è¦åŠŸèƒ½
2. é«˜é£é™©ç”¨ä¾‹å·²è¦†ç›–å¹¶æµ‹è¯•é€šè¿‡
3. è¾¹ç•Œæƒ…å†µå’Œé”™è¯¯å¤„ç†éƒ½æœ‰æµ‹è¯•
4. æµ‹è¯•ä»£ç æ¸…æ™°æ˜“è¯»
5. Mockç­–ç•¥åˆç†ï¼Œé¿å…äº†ä¾èµ–çœŸå®DOM

### æ”¹è¿›ç©ºé—´
1. å¯ä»¥æ·»åŠ æ›´å¤šé›†æˆæµ‹è¯•
2. å¯ä»¥æ·»åŠ æ€§èƒ½æµ‹è¯•ï¼ˆå¤§é‡å‘½ä»¤æ‰§è¡Œï¼‰
3. å¯ä»¥æ·»åŠ æ›´å¤šå®é™…åœºæ™¯çš„ç«¯åˆ°ç«¯æµ‹è¯•

---

## ç»´æŠ¤å»ºè®®

1. **æ·»åŠ æ–°å‘½ä»¤æ—¶**: å‚è€ƒç°æœ‰æµ‹è¯•æ¨¡å¼ï¼Œæ·»åŠ å¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹
2. **ä¿®æ”¹å‘½ä»¤é€»è¾‘æ—¶**: ç¡®ä¿ç°æœ‰æµ‹è¯•ä»ç„¶é€šè¿‡
3. **æ·»åŠ æ–°åŠŸèƒ½æ—¶**: å…ˆå†™æµ‹è¯•ï¼Œå†å®ç°åŠŸèƒ½
4. **é‡æ„æ—¶**: ä¿æŒæµ‹è¯•è¦†ç›–ç‡ä¸ä¸‹é™

---

## ç›¸å…³æ–‡ä»¶

- æºæ–‡ä»¶: `components/editor/toolbar/hooks/useEditorCommands.ts`
- æµ‹è¯•æ–‡ä»¶: `test/editor/useEditorCommands.test.ts`
- æµ‹è¯•å·¥å…·: `test/utils/test-utils.tsx`
- æ ·å¼å·¥å…·: `components/editor/utils/style.ts`

---

æµ‹è¯•å®Œæˆæ—¥æœŸ: 2026-01-24
æµ‹è¯•å·¥ç¨‹å¸ˆ: Claude
ç‰ˆæœ¬: 1.0.0
